apiVersion: v1
kind: Pod
metadata:
  name: amurali-re
  labels:
    k8s-app: amurali-re
  namespace: sbks
spec:
  containers:
  - name: amurali
    image: akdec00/llm-torch:latest
    imagePullPolicy: Always
    args: ["sleep", "36500000"]
    resources:
      limits:
        memory: "32G"
        cpu: 2
        nvidia.com/gpu: 1
      requests:
        memory: "32G"
        cpu: 2
        nvidia.com/gpu: 1
    volumeMounts:
      - mountPath: "/sbksvol"
        name: sbksvol
    env:
    - name: PYTHONPATH
      value: "/root/sbks-ucsd/relation-extraction/biobert_RE"
    - name: GITLAB_TOKEN
      valueFrom: 
        secretKeyRef: 
          name: re-gitlab-readonly
          key: token
  restartPolicy: Never
  automountServiceAccountToken: false
  volumes:
    - name: sbksvol
      persistentVolumeClaim:
        claimName: sbksvol
    - name: re-gitlab-readonly
      secret:
        secretName: re-gitlab-readonly
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
            - key: nvidia.com/gpu.product
              operator: In
                # Specifies GPU types
              values:
                - NVIDIA-A100-SXM4-80GB
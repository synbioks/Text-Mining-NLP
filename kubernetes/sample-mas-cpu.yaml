apiVersion: v1
kind: Pod
metadata:
  name: mai-cpu
  labels:
    k8s-app: mai-cpu
  namespace: mas-fuelmap
spec:
  containers:
  - name: mai-cpu
    image: sdsc/words-tensorflow-py3
    imagePullPolicy: Always
    # args: ["sleep", "36500000"]
    #args: ["python3", "/usr/local/bin/jupyter-notebook", "--ip=*", "--port=8888", "--allow-root", "--NotebookApp.iopub_data_rate_limit=2147483647"]
    resources:
      limits:
        memory: "4G"
        cpu: 4
        nvidia.com/gpu: 0
      requests:
        memory: "4G"
        cpu: 2
        nvidia.com/gpu: 0
    volumeMounts:
      - mountPath: "/cephfs"
        name: cephfs
  restartPolicy: Never
  volumes:
    - name: cephfs
      flexVolume:
        driver: ceph.rook.io/rook
        fsType: ceph
        options:
          fsName: nautilusfs
          clusterNamespace: rook
          path: /fuelmap
          mountUser: fuelmap
          mountSecret: ceph-fs-secret
---
kind: Service
apiVersion: v1
metadata:
  labels:
    k8s-app: mai-cpu
  name: mai-cpu
spec:
  type: NodePort
  ports:
  - port: 8888
    name: web
  selector:
    k8s-app: mai-cpu
